<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://www.huashuimao.cn/upload/01e955ad01d6aba306003cefa757a4a6_1.jpg">
    <base href="https://www.huashuimao.cn" target="_blank">
    <title>ç¾¤èŠå¹¿åœº</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Helvetica Neue", Arial, sans-serif;
        }

        body {
            background-color: #f7f9fc;
            color: #333;
            line-height: 1.5;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            min-height: 100vh;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
            position: relative;
        }

        .header {
            padding: 18px 20px;
            background: linear-gradient(to right, #1abc9c, #3498db);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            color: white;
            border-radius: 0 0 10px 10px;
        }

        .header-title {
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }

        .header-subtitle {
            font-size: 12px;
            margin-top: 5px;
            opacity: 0.85;
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            /* æ·»åŠ è¿™è¡Œä½¿tabsè‡ªåŠ¨æ¢è¡Œ */
            padding: 15px;
            background-color: #fff;
            border-bottom: 1px solid #eee;
            /* ç§»é™¤ä»¥ä¸‹æ¨ªå‘æ»šåŠ¨ç›¸å…³çš„æ ·å¼ */
            /* overflow-x: auto; */
            /* white-space: nowrap; */
            /* -webkit-overflow-scrolling: touch; */
            /* scrollbar-width: none; */
        }

        /* å¯ä»¥ç§»é™¤è¿™ä¸ªï¼Œå› ä¸ºä¸å†éœ€è¦éšè—æ»šåŠ¨æ¡ */
        /* .tabs::-webkit-scrollbar {
        display: none;
    } */

        /* ä¸ºtabæ·»åŠ ä¸‹è¾¹è·ï¼Œç¡®ä¿æ¢è¡Œåæœ‰è¶³å¤Ÿé—´è· */
        .tab {
            padding: 8px 16px;
            margin-right: 12px;
            margin-bottom: 10px;
            /* æ·»åŠ è¿™è¡Œï¼Œç¡®ä¿æ¢è¡Œåçš„è¡Œé—´è· */
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }


        .tab:hover {
            background-color: #f5f9f8;
        }

        .tab.active {
            background-color: #e8f7f0;
            color: #1abc9c;
            font-weight: 500;
            border: 1px solid #c5ede3;
            box-shadow: 0 2px 5px rgba(26, 188, 156, 0.1);
        }

        .tab-filter {
            color: #7f8c8d;
            display: flex;
            align-items: center;
            background-color: #f7f9fc;
            border: 1px solid #e5e5e5;
        }

        .tab-filter::after {
            content: "â–¼";
            font-size: 10px;
            margin-left: 5px;
            transition: transform 0.3s ease;
        }

        .tab-filter:hover::after {
            transform: translateY(2px);
        }

        .group-list {
            padding: 15px;
        }

        .group-item {
            padding: 18px;
            background-color: #fff;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border: 1px solid #f0f0f0;
        }

        .group-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .group-info {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .group-avatar {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            overflow: hidden;
            margin-right: 15px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            background-color: #f5f5f5;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .avatar-part {
            width: 25px;
            height: 25px;
            background-size: cover;
        }

        .group-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            overflow: hidden;
            margin-right: 15px;
            object-fit: cover;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .group-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #2c3e50;
        }

        .group-status {
            font-size: 13px;
            color: #7f8c8d;
            display: flex;
            align-items: center;
        }

        .group-status::before {
            content: "";
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #1abc9c;
            margin-right: 6px;
        }

        .join-btn {
            padding: 8px 22px;
            background-color: #fff;
            color: #1abc9c;
            border: 1.5px solid #1abc9c;
            border-radius: 25px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            outline: none;
        }

        .join-btn:hover {
            background-color: #1abc9c;
            color: white;
            box-shadow: 0 4px 10px rgba(26, 188, 156, 0.2);
        }

        .join-btn:active {
            transform: scale(0.97);
        }

        /* å¼¹çª—æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(3px);
            -webkit-backdrop-filter: blur(3px);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background-color: #fff;
            border-radius: 15px;
            width: 85%;
            max-width: 340px;
            padding: 25px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 22px;
            color: #bbb;
            cursor: pointer;
            background: none;
            border: none;
            transition: all 0.3s ease;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-btn:hover {
            background-color: #f5f5f5;
            color: #777;
        }

        .qr-title {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 15px;
        }

        .step-number {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #1abc9c, #3498db);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 15px;
            margin-bottom: 8px;
            box-shadow: 0 3px 8px rgba(52, 152, 219, 0.3);
        }

        .step-text {
            font-size: 14px;
            color: #3498db;
            font-weight: 500;
        }

        .qr-code {
            text-align: center;
            margin: 20px 0;
            position: relative;
            max-width: 100%;
            /* ç¡®ä¿å®¹å™¨ä¸ä¼šè¶…å‡ºçˆ¶å…ƒç´ å®½åº¦ */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .qr-code::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            /* ä½¿ç”¨ç™¾åˆ†æ¯”ï¼Œä½¿èƒŒæ™¯éšå›¾ç‰‡å¤§å°å˜åŒ– */
            max-width: 200px;
            /* è®¾ç½®æœ€å¤§å®½åº¦ */
            aspect-ratio: 1 / 1;
            /* ä¿æŒ1:1çš„å®½é«˜æ¯” */
            border-radius: 10px;
            background: radial-gradient(circle at center, rgba(26, 188, 156, 0.1) 0%, transparent 70%);
            z-index: -1;
        }

        .qr-code img {
            width: 80%;
            /* ä½¿ç”¨ç™¾åˆ†æ¯”ï¼Œä½¿å›¾ç‰‡è‡ªé€‚åº” */
            max-width: 180px;
            /* è®¾ç½®æœ€å¤§å®½åº¦ */
            height: auto;
            /* é«˜åº¦è‡ªåŠ¨è°ƒæ•´ï¼Œä¿æŒå®½é«˜æ¯” */
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 3px solid white;
            object-fit: contain;
            /* ç¡®ä¿å›¾ç‰‡å®Œæ•´æ˜¾ç¤º */
        }


        .qr-tip {
            text-align: center;
            font-size: 13px;
            color: #7f8c8d;
            margin-top: 15px;
            background-color: #f7f9fc;
            padding: 8px 15px;
            border-radius: 20px;
            /* display: inline-block; */
            margin-left: auto;
            margin-right: auto;
        }

        /* ç­›é€‰å¼¹çª— */
        .filter-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            justify-content: center;
            align-items: flex-start;
            backdrop-filter: blur(3px);
            -webkit-backdrop-filter: blur(3px);
        }

        .filter-content {
            background-color: #fff;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            padding: 25px;
            margin-top: 70px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: slideDown 0.4s ease;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .filter-title {
            text-align: center;
            font-size: 18px;
            margin-bottom: 25px;
            font-weight: 600;
            color: #2c3e50;
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
        }

        .filter-option {
            padding: 10px 18px;
            background-color: #f7f9fc;
            border-radius: 25px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }

        .filter-option:hover {
            background-color: #f0f7f4;
            border-color: #d5e8e2;
        }

        .filter-option.active {
            background-color: #e8f7f0;
            color: #1abc9c;
            border-color: #c5ede3;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(26, 188, 156, 0.15);
        }

        .loading {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            font-size: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .loading::before {
            content: "";
            width: 30px;
            height: 30px;
            border: 3px solid #e8f7f0;
            border-top: 3px solid #1abc9c;
            border-radius: 50%;
            margin-bottom: 15px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* é¡µé¢æ»šåŠ¨æ¡ç¾åŒ– */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f5f5f5;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #aaa;
        }

        /* ç©ºçŠ¶æ€æç¤º */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #95a5a6;
        }

        .empty-state::before {
            content: "ğŸ“‹";
            font-size: 40px;
            display: block;
            margin-bottom: 15px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <div>
                <div class="header-title">å¦‚æ˜¯è¨€å®¢æœåœˆå­</div>
                <div class="header-subtitle">ä¸“ä¸šäº¤æµ Â· èµ„æºå…±äº«</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active">å…¨éƒ¨</div>
            <div class="tab tab-filter" id="filterBtn">ç­›é€‰</div>
        </div>

        <div class="group-list" id="groupList">
            <div class="loading">åŠ è½½ä¸­...</div>
        </div>
    </div>

    <!-- åŠ ç¾¤äºŒç»´ç å¼¹çª— -->
    <div class="modal" id="qrModal">
        <div class="modal-content">
            <button class="close-btn" id="closeModal">Ã—</button>
            <div class="qr-title">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-text">æ‰«ç åŠ ç¾¤</div>
                </div>
            </div>
            <div class="qr-tip">é•¿æŒ‰æ‰«ç ï¼Œæˆ–è€…ä½¿ç”¨å¾®ä¿¡æ‰«ä¸€æ‰«</div>
            <div class="qr-code">
                <img id="qrCodeImage" alt="QR Code">
            </div>

        </div>
    </div>

    <!-- ç­›é€‰å¼¹çª— -->
    <div class="filter-modal" id="filterModal">
        <div class="filter-content">
            <button class="close-btn" id="closeFilterModal">Ã—</button>
            <div class="filter-title">ç­›é€‰ç¾¤ç±»å‹</div>
            <div class="filter-options" id="filterOptions">
                <!-- ç­›é€‰é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡å­˜å‚¨æ•°æ®
        let linkGroups = [];
        let links = [];
        let groupTypes = ['å…¨éƒ¨'];
        let currentFilter = 'å…¨éƒ¨';

        // éœ€è¦æ’é™¤çš„åˆ†ç»„ID
        const EXCLUDED_GROUP_ID = 'link-group-xXGJL';

        // è·å–é“¾æ¥åˆ†ç»„æ•°æ®
        async function fetchLinkGroups() {
            headers = {
                'Authorization': 'Bearer pat_eyJraWQiOiJzNGxBLVREb05FaWNvNGY2OHBfc2dicDJLY2lSZGZsVkVnV3prcEx3YlY4IiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL3d3dy5odWFzaHVpbWFvLmNuIiwic3ViIjoiaHVhc2h1aW1hbyIsImlhdCI6MTc0MjM4ODA3MCwianRpIjoiZjkzYTBhZjAtOTAxYS1mYjlmLTY4OTUtNWU3Zjk5ODBmOTJlIiwicGF0X25hbWUiOiJwYXQtaHVhc2h1aW1hby14WXBOcyJ9.dHU_8f3fl2PYCoIPgQajNNKE2jMG90g0N4vPb56V0uhk_jhlRaRgs2D_dLk92Uy7uLTw-W1ZL7ELhIMB7tjbUzlq2hZXEEO_6ZUr_ihXceWJ6knbcYIjZCZ9hVol93y0lEtVIiDlo8ntcXUPoc_212ZUPOIV51uhiOM7pPtj3EqIIcXJyGpMJWbSYjviUddlJbKndA_ugv9xc21fnMK8nGb9y8Y_qvvZYig58xJ6TTZh9xfvSAKBDQ-D6AnQ-JSKHVoZVsAdskC4p0osSaDytyyjUBH1Qy22wUGE-Bg8o-UdJq08gNg-TkNpytr5e90-H3OYkr9Ay1FmbU5R6YrLQoetKto2DZOE-Mj_d9cGq5ICrEMWJgPKnmrr2YBmGj3WjQ3ufP1flCjswoVZjcXhMvjtWLx4rK7a3W9ypq4g1uG819I4kR0ZyMDhpG5VwLXtE0_B0z4LCch84Xehwv-K3BAgnWJPUSBNB2M7wIunqE3VkRKWdRQb_WoFRTpiOH-21t9hp7MZcmqxlvpD_-pngV5sO7GSka9-X0BM9q45XDic8cDKoO5ZTkPyuFZDabXgTlia4WeQ_xOQwew_CYNirTyNbqyElD3wW6zLnbEGh4vHBxYfLr8uMHnKvYv-XgacdPNzpzFi5RwsOSZfyki1OzIVDiey48ng5IM20uqUYP4'
            }

            try {
                const response = await fetch('https://www.huashuimao.cn/apis/core.halo.run/v1alpha1/linkgroups?page=1&size=200', {
                    method: 'GET',
                    headers: headers
                });
                const data = await response.json();

                // è¿‡æ»¤æ‰éœ€è¦æ’é™¤çš„åˆ†ç»„
                return (data.items || []).filter(group => group.metadata.name !== EXCLUDED_GROUP_ID);
            } catch (error) {
                console.error('è·å–é“¾æ¥åˆ†ç»„å¤±è´¥:', error);
                return [];
            }
        }

        // è·å–é“¾æ¥æ•°æ®
        async function fetchLinks() {
            try {
                const response = await fetch('https://www.huashuimao.cn/apis/core.halo.run/v1alpha1/links?page=1&size=200', {
                    method: 'GET',
                    headers: headers
                });
                const data = await response.json();

                // è¿‡æ»¤æ‰å±äºè¢«æ’é™¤åˆ†ç»„çš„é“¾æ¥
                return (data.items || []).filter(link => link.spec.groupName !== EXCLUDED_GROUP_ID);
            } catch (error) {
                console.error('è·å–é“¾æ¥å¤±è´¥:', error);
                return [];
            }
        }

        // åˆå§‹åŒ–æ•°æ®
        async function initData() {
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('groupList').innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';

            try {
                // è·å–æ•°æ®
                linkGroups = await fetchLinkGroups();
                links = await fetchLinks();

                // æå–æ‰€æœ‰çš„åˆ†ç»„ç±»å‹ï¼ˆç”¨äºç­›é€‰ï¼‰
                linkGroups.forEach(group => {
                    const displayName = group.spec.displayName;
                    if (!groupTypes.includes(displayName)) {
                        groupTypes.push(displayName);
                    }
                });

                // æ¸²æŸ“é€‰é¡¹å¡
                renderTabs();

                // æ¸²æŸ“ç­›é€‰é€‰é¡¹
                renderFilterOptions();

                // æ¸²æŸ“ç¾¤ç»„åˆ—è¡¨
                renderGroups();
            } catch (error) {
                console.error('åˆå§‹åŒ–æ•°æ®å¤±è´¥:', error);
                document.getElementById('groupList').innerHTML =
                    '<div class="empty-state">åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åå†è¯•</div>';
            }
        }

        // æ¸²æŸ“é€‰é¡¹å¡
        function renderTabs() {
            const tabsContainer = document.querySelector('.tabs');
            // æ¸…é™¤ç°æœ‰é€‰é¡¹å¡ï¼Œä¿ç•™"å…¨éƒ¨"å’Œ"ç­›é€‰"
            tabsContainer.innerHTML = '<div class="tab active">å…¨éƒ¨</div>';

            // æ·»åŠ å‰4ä¸ªåˆ†ç»„ä½œä¸ºé€‰é¡¹å¡ï¼Œé¿å…é€‰é¡¹å¡è¿‡å¤šå¯¼è‡´UIæ‹¥æŒ¤
            const displayGroups = linkGroups.slice(0, 4);
            displayGroups.forEach(group => {
                const displayName = group.spec.displayName;
                tabsContainer.innerHTML += `<div class="tab">${displayName}</div>`;
            });

            // æ·»åŠ ç­›é€‰æŒ‰é’®
            tabsContainer.innerHTML += '<div class="tab tab-filter" id="filterBtn">ç­›é€‰</div>';

            // é‡æ–°ç»‘å®šç­›é€‰æŒ‰é’®äº‹ä»¶
            document.getElementById('filterBtn').addEventListener('click', function () {
                document.getElementById('filterModal').style.display = 'flex';
            });

            // ç»‘å®šé€‰é¡¹å¡ç‚¹å‡»äº‹ä»¶

            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    if (this.classList.contains('tab-filter')) return;

                    // æ›´æ–°é€‰é¡¹å¡çŠ¶æ€
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    currentFilter = this.textContent;

                    // æ›´æ–°ç­›é€‰æŒ‰é’®æ–‡æœ¬
                    if (currentFilter !== 'å…¨éƒ¨') {
                        document.getElementById('filterBtn').textContent = `ç­›é€‰ï¼š${currentFilter}`;
                    } else {
                        document.getElementById('filterBtn').textContent = 'ç­›é€‰';
                    }

                    // æ¸²æŸ“ç¾¤ç»„
                    renderGroups();
                });
            });

        }

        // æ¸²æŸ“ç­›é€‰é€‰é¡¹
        function renderFilterOptions() {
            const filterOptions = document.getElementById('filterOptions');
            filterOptions.innerHTML = '';

            groupTypes.forEach(type => {
                const option = document.createElement('div');
                option.className = 'filter-option';
                if (type === currentFilter) {
                    option.classList.add('active');
                }
                option.textContent = type;

                option.addEventListener('click', function () {
                    // æ›´æ–°ç­›é€‰æŒ‰é’®æ–‡æœ¬
                    if (type !== 'å…¨éƒ¨') {
                        document.getElementById('filterBtn').textContent = `ç­›é€‰ï¼š${type}`;
                    } else {
                        document.getElementById('filterBtn').textContent = 'ç­›é€‰';
                    }

                    // æ›´æ–°é€‰é¡¹å¡çŠ¶æ€
                    document.querySelectorAll('.tab').forEach(tab => {
                        if (tab.textContent === type) {
                            tab.classList.add('active');
                        } else {
                            tab.classList.remove('active');
                        }
                    });

                    currentFilter = type;

                    // æ¸²æŸ“ç¾¤ç»„
                    renderGroups();

                    // å…³é—­ç­›é€‰å¼¹çª—
                    document.getElementById('filterModal').style.display = 'none';
                });

                filterOptions.appendChild(option);
            });
        }

        // æ¸²æŸ“ç¾¤ç»„åˆ—è¡¨
        function renderGroups() {
            const groupList = document.getElementById('groupList');
            groupList.innerHTML = '';

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            groupList.innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';

            // ç­›é€‰é“¾æ¥
            let filteredLinks = links;
            if (currentFilter !== 'å…¨éƒ¨') {
                // æ‰¾åˆ°å¯¹åº”åˆ†ç»„çš„åç§°
                const group = linkGroups.find(g => g.spec.displayName === currentFilter);
                if (group) {
                    const groupName = group.metadata.name;
                    filteredLinks = links.filter(link => link.spec.groupName === groupName);
                }
            }

            // ç¡®ä¿ä¸æ˜¾ç¤ºè¢«æ’é™¤åˆ†ç»„çš„é“¾æ¥
            filteredLinks = filteredLinks.filter(link => link.spec.groupName !== EXCLUDED_GROUP_ID);

            // æ¸…é™¤åŠ è½½çŠ¶æ€
            groupList.innerHTML = '';

            if (filteredLinks.length === 0) {
                groupList.innerHTML = '<div class="empty-state">æš‚æ— ç›¸å…³ç¾¤ç»„</div>';
                return;
            }

            // æ¸²æŸ“é“¾æ¥
            filteredLinks.forEach(link => {
                const groupItem = document.createElement('div');
                groupItem.className = 'group-item';

                // è·å–é“¾æ¥æ‰€å±åˆ†ç»„
                const group = linkGroups.find(g => g.metadata.name === link.spec.groupName);
                const groupDisplayName = group ? group.spec.displayName : 'æœªåˆ†ç±»';

                // ä½¿ç”¨é“¾æ¥çš„logoæˆ–ç”Ÿæˆéšæœºå¤´åƒ
                let avatarHtml = '';
                if (link.spec.logo) {
                    avatarHtml = `<img src="${link.spec.logo}" alt="${link.spec.displayName}" class="group-logo">`;
                } else {
                    // éšæœºç”Ÿæˆå¤´åƒé¢œè‰² - ä½¿ç”¨æ›´ç¾è§‚çš„é¢œè‰²ç»„åˆ
                    const colors = [
                        '#3498db', '#2ecc71', '#e74c3c', '#f39c12',
                        '#9b59b6', '#1abc9c', '#d35400', '#c0392b'
                    ];
                    avatarHtml = `
                        <div class="group-avatar">
                            <div class="avatar-part" style="background-color: ${colors[Math.floor(Math.random() * colors.length)]}"></div>
                            <div class="avatar-part" style="background-color: ${colors[Math.floor(Math.random() * colors.length)]}"></div>
                            <div class="avatar-part" style="background-color: ${colors[Math.floor(Math.random() * colors.length)]}"></div>
                            <div class="avatar-part" style="background-color: ${colors[Math.floor(Math.random() * colors.length)]}"></div>
                        </div>
                    `;
                }

                groupItem.innerHTML = `
                    <div class="group-info">
                        ${avatarHtml}
                        <div>
                            <div class="group-name">${link.spec.displayName}</div>
                            <div class="group-status">${groupDisplayName}</div>
                        </div>
                    </div>
                    <button class="join-btn" data-id="${link.metadata.name}" data-url="${link.spec.url}">åŠ å…¥</button>
                `;

                groupList.appendChild(groupItem);
            });

            // æ·»åŠ åŠ å…¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.join-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    const linkId = this.getAttribute('data-id');
                    const url = this.getAttribute('data-url');
                    showQrModal(linkId, url);
                });
            });
        }

        // æ˜¾ç¤ºäºŒç»´ç å¼¹çª—
        function showQrModal(linkId, url) {
            // æŸ¥æ‰¾å¯¹åº”çš„é“¾æ¥
            const link = links.find(l => l.metadata.name === linkId);
            if (link && link.spec.logo) {
                // å¦‚æœæœ‰logoï¼Œä½¿ç”¨logoä½œä¸ºäºŒç»´ç 
                document.getElementById('qrCodeImage').src = link.spec.logo;
            }

            // æ˜¾ç¤ºå¼¹çª—
            document.getElementById('qrModal').style.display = 'flex';
        }

        // å…³é—­äºŒç»´ç å¼¹çª—
        document.getElementById('closeModal').addEventListener('click', function () {
            document.getElementById('qrModal').style.display = 'none';
        });

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­å¼¹çª—
        document.getElementById('qrModal').addEventListener('click', function (event) {
            if (event.target === this) {
                this.style.display = 'none';
            }
        });

        // å…³é—­ç­›é€‰å¼¹çª—
        document.getElementById('closeFilterModal').addEventListener('click', function () {
            document.getElementById('filterModal').style.display = 'none';
        });

        // ç‚¹å‡»ç­›é€‰å¼¹çª—å¤–éƒ¨å…³é—­å¼¹çª—
        document.getElementById('filterModal').addEventListener('click', function (event) {
            if (event.target === this) {
                this.style.display = 'none';
            }
        });

        // æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
        function handleApiError(error, retryFunction, maxRetries = 3, delay = 1000) {
            let retryCount = 0;

            function retry() {
                if (retryCount < maxRetries) {
                    retryCount++;
                    console.log(`é‡è¯•ç¬¬ ${retryCount} æ¬¡...`);
                    setTimeout(() => {
                        retryFunction();
                    }, delay);
                } else {
                    console.error('è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ“ä½œå¤±è´¥');
                    document.getElementById('groupList').innerHTML =
                        '<div class="empty-state">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
                }
            }

            console.error('APIè¯·æ±‚é”™è¯¯:', error);
            retry();
        }

        // åˆå§‹åŒ–
        initData();
    </script>
</body>

</html>
